{% extends 'dashboard/user/user_base.html' %}
{% load static %}

{% block content %}
 <div class="container-fluid dashboard-content">
    <div class="row">
        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
            <h3 class="text-center">Welcome, {{user.first_name}}</h3>
        </div>
    </div>
    <div class="row">
        <!-- cards will go here hopefully :( -->
        <!-- grid column -->
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 col-12">
            <!-- .card -->
            <a href="reqdoc">
            <div class="card card-figure has-hoverable bg-info">
                <!-- .card-figure -->
                <figure class="figure">
                    <img class="img-fluid" src="{% static 'assets/images/explorepatient.png' %}" alt="New Requests" style="height: 150px;">
                    <!-- .figure-caption -->
                    <figcaption class="figure-caption">
                        <h6 class="figure-title"> New Request </h6>
                        <!-- <p class="text-muted mb-0"> Give some text description </p> -->
                    </figcaption>
                    <!-- /.figure-caption -->
                </figure>
                <!-- /.card-figure -->
            </div>
            <!-- /.card -->
            </a>
        </div>
        <!-- /grid column -->
        <!-- grid column -->
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 col-12">
            <!-- .card -->
            <a href="showreq">
            <div class="card card-figure has-hoverable bg-warning">
                <!-- .card-figure -->
                <figure class="figure">
                    <img class="img-fluid" src="{% static 'assets/images/viewAtten.png' %}" alt="Past Diagnosis" style="height: 150px;">
                    <!-- .figure-caption -->
                    <figcaption class="figure-caption">
                        <h6 class="figure-title"> Appointments </h6>
                        <!-- <p class="text-muted mb-0"> Give some text description </p> -->
                    </figcaption>
                    <!-- /.figure-caption -->
                </figure>
                <!-- /.card-figure -->
            </div>
            </a>
            <!-- /.card -->
        </div>
        <!-- /grid column -->

        <!-- grid column -->
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 col-12">
            <!-- .card -->
            <a href="showorders">
            <div class="card card-figure has-hoverable bg-danger">
                <!-- .card-figure -->
                <figure class="figure">
                    <img class="img-fluid" src="{% static 'assets/images/calendar.png' %}" alt="Calendar" style="height: 150px;">
                    <!-- .figure-caption -->
                    <figcaption class="figure-caption">
                        <h6 class="figure-title"> Past Orders </h6>
                        <!-- <p class="text-muted mb-0"> Give some text description </p> -->
                    </figcaption>
                    <!-- /.figure-caption -->
                </figure>
                <!-- /.card-figure -->
            </div>
            </a>
            <!-- /.card -->
        </div>
        <!-- /grid column -->

        <!-- grid column -->
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 col-12">
            <!-- .card -->
            <a href="reqpharma">
            <div class="card card-figure has-hoverable bg-success">
                <!-- .card-figure -->
                <figure class="figure">
                    <img class="img-fluid" src="{% static 'assets/images/classAnal.png' %}" alt="Analysis" style="height: 150px;">
                    <!-- .figure-caption -->
                    <figcaption class="figure-caption">
                        <h6 class="figure-title"> Place Order </h6>
                        <!-- <p class="text-muted mb-0"> Give some text description </p> -->
                    </figcaption>
                    <!-- /.figure-caption -->
                </figure>
                <!-- /.card-figure -->
            </div>
        </a>
            <!-- /.card -->
        </div>
        <!-- /grid column -->

    </div>

<div class="row">
      <!-- ============================================================== -->
      <!-- data table  -->
      <!-- ============================================================== -->
      <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
          <div class="card">
              <div class="card-header">
                  <h5 class="mb-0">Your Current Appointments....</h5>
                  <!-- <p>This example shows DataTables and the Buttons extension being used with the Bootstrap 4 framework providing the styling.</p> -->
              </div>
              <div class="card-body text-center">
                  <div class="table-responsive">
                      <table id="example" class="table table-striped table-bordered second text-dark"
                          style="width:100%">
                          <thead> 
                            <tr>
                                <th>#</th>
                                <th>Doctor</th>
                                <th>AI Diagnosis</th>
                                <th>Request Date</th>
                                <th>Appointment On</th>
                                <th style="display: none;">ID</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                        {%for i,req,num in data1 %}    
                        <tr>
                                <td>{{num}}</td>
                                <td >{{i.0.name}}</td>
                                <td>Something</td>
                                <td>{{req.rdate}}</td>
                                {% if req.adate is not null %}
                                    <td>{{req.adate}}</td>
                                {% else %}
                                    <td>No Response</td>
                                {% endif %}
                                <td style="display: none;">{{req.id}}</td>
                                    
                                <td>
                                    <i class="fa fa-edit" aria-hidden="true"></i>
                                    <i class="fa fa-eye" aria-hidden="true"></i>
                                    <i class="fa fa-window-close" aria-hidden="true"></i>
                                </td>
                            </tr>

                        {% endfor %}
                      </table>
                      <a class="btn btn-rounded btn-secondary float-right" href="showreq" style="margin-top: 5px;">View All ..</a>
                  </div>
              </div>
          </div>
      </div>
      <!-- ============================================================== -->
      <!-- end data table  -->
      <!-- ============================================================== -->
  </div>
        <script>
            $(document).ready(function () {
                var table = $('#example').DataTable();
                
                
                $('.button').on('click', function () {
                    
                    var $row=$(this).closest("tr")
                    var $text = $row.find(".nr").text(); // Find the text
                    
                    var ids = $.map(table.rows($row).data(), function (item) {
                        return item
                    });
                    var id=ids[1]
                    var tid=ids[7]
                    
                    $.ajax({
                        type: "POST",
                        data: {id:id,tid:tid},
                        url: "docshowappo",
                        }).done(function( data ) {
                            $("#requested").html("Your Appointment is Schedule with  "+ids[2]);
                            
                            document.location.href="docshowappo"
                        
                        });

                });
            });
        </script>
{% endblock content %}